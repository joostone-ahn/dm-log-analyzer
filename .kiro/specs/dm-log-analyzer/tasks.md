# DM Log Call Flow Analyzer - 구현 태스크

## 1. 백엔드 핵심 기능

### 1.1 파일 변환 파이프라인
- [x] 1.1.1 의존성 체크 함수 구현 (scat, tshark)
- [x] 1.1.2 DM 로그 → PCAP 변환 함수 구현
- [x] 1.1.3 PCAP → JSON 변환 함수 구현
- [x] 1.1.4 중복 키 처리 JSON 파서 구현
- [x] 1.1.5 Lua 플러그인 통합
- [x] 1.1.6 PDML 포맷 추가 저장
- [x] 1.1.7 Lua 플러그인 전역 경로 지원 (Docker)

### 1.2 프로토콜 파싱
- [x] 1.2.1 LTE RRC 메시지 파싱 구현
- [x] 1.2.2 NR RRC 메시지 파싱 구현
- [x] 1.2.3 NAS 5GS 메시지 파싱 구현
- [x] 1.2.4 NAS EPS 메시지 파싱 구현
- [x] 1.2.5 메시지 타입 변환 테이블 구현 (3GPP 표준 기반)
- [x] 1.2.6 GSMTAPv3 배열 형식 지원 (NR/LTE RRC)

### 1.3 중첩 메시지 처리
- [x] 1.3.1 RRC 내 NAS 메시지 추출
- [x] 1.3.2 LTE RRC 내 NR RRC 메시지 추출 (EN-DC)
- [x] 1.3.3 NAS Transport 내 NAS 메시지 추출
- [x] 1.3.4 SystemInformation 내 SIB 타입 추출

### 1.4 방향 및 노드 판단
- [x] 1.4.1 메시지 방향 자동 판단 (UL/DL)
- [x] 1.4.2 프로토콜별 노드 매핑 (UE, eNB, gNB, MME, AMF)
- [x] 1.4.3 채널 타입 기반 방향 판단 (CCCH, DCCH, BCCH, PCCH)

### 1.5 PCO 필드 향상
- [x] 1.5.1 PCO Protocol ID 매핑 테이블 구현
- [x] 1.5.2 IPv4/IPv6 주소 추출
- [x] 1.5.3 향상된 데이터 구조 생성 (_enhanced_items)

### 1.6 Call Flow 파싱
- [x] 1.6.1 JSON → Call Flow 데이터 변환
- [x] 1.6.2 타임스탬프 포맷 변환 (hh:mm:ss.ms)
- [x] 1.6.3 프로토콜별 레이어 추출
- [x] 1.6.4 디버그 정보 저장
- [x] 1.6.5 NR RRC 전용 디버그 섹션 추가

### 1.7 Flask 라우트
- [x] 1.7.1 메인 페이지 라우트 구현
- [x] 1.7.2 파일 업로드 라우트 구현
- [x] 1.7.3 에러 처리 및 응답 구현
- [x] 1.7.4 PCAP 직접 업로드 지원

---

## 2. 프론트엔드 UI

### 2.1 레이아웃
- [x] 2.1.1 헤더 섹션 구현 (제목 + 업로드 버튼)
- [x] 2.1.2 로딩 스피너 구현
- [x] 2.1.3 에러 메시지 영역 구현
- [x] 2.1.4 Call Flow 컨테이너 구현

### 2.2 Call Flow 다이어그램
- [x] 2.2.1 노드 헤더 구현 (5개 노드)
- [x] 2.2.2 노드별 색상 스타일링
- [x] 2.2.3 세로선 구현 (노드 아래로 연장)
- [x] 2.2.4 메시지 행 구현 (타임스탬프 + 화살표)
- [x] 2.2.5 화살표 위치 자동 계산
- [x] 2.2.6 화살표 방향 표시 (UL/DL 색상 구분)
- [x] 2.2.7 메시지 라벨 구현 (중첩 메시지 표시)

### 2.3 상세 정보 패널
- [x] 2.3.1 슬라이드 인 패널 구현
- [x] 2.3.2 기본 정보 섹션 구현
- [x] 2.3.3 IE 트리 뷰 구현
- [x] 2.3.4 트리 렌더링 함수 구현
- [x] 2.3.5 색상 구분 (키, 값, 타입별)
- [x] 2.3.6 닫기 버튼 및 ESC 키 지원

### 2.4 JavaScript 로직
- [x] 2.4.1 파일 업로드 처리 함수
- [x] 2.4.2 Call Flow 표시 함수
- [x] 2.4.3 노드 위치 계산 로직
- [x] 2.4.4 상세 정보 표시 함수
- [x] 2.4.5 트리 렌더링 함수
- [x] 2.4.6 PCO 향상 데이터 우선 표시

---

## 3. 추가 분석 스크립트

### 3.1 RTCP 품질 분석
- [x] 3.1.1 TFT 포트 추출 함수 구현
- [x] 3.1.2 MOS 계산 함수 구현 (E-Model)
- [x] 3.1.3 RTCP SR/RR 메시지 파싱
- [x] 3.1.4 Reporter 판단 (UE/Server)
- [x] 3.1.5 DL/UL Stream 구분
- [x] 3.1.6 CSV 파일 저장

### 3.2 SA 세션 분석
- [x] 3.2.1 PDU Session Establishment Accept 파싱
- [x] 3.2.2 DNN, SST, SD, AMBR 추출
- [x] 3.2.3 QoS Flow 정보 추출
- [x] 3.2.4 Default Flow 판단
- [x] 3.2.5 matplotlib 시각화
- [x] 3.2.6 PNG 파일 저장

---

## 4. 테스트 및 검증

### 4.1 단위 테스트
- [ ] 4.1.1 메시지 타입 변환 테스트
- [ ] 4.1.2 방향 판단 테스트
- [ ] 4.1.3 중첩 메시지 추출 테스트
- [ ] 4.1.4 PCO 필드 향상 테스트
- [ ] 4.1.5 타임스탬프 포맷 테스트

### 4.2 통합 테스트
- [ ] 4.2.1 HDF 파일 변환 테스트
- [ ] 4.2.2 SDM 파일 변환 테스트
- [ ] 4.2.3 QMDL 파일 변환 테스트
- [ ] 4.2.4 PCAP 파일 직접 업로드 테스트
- [ ] 4.2.5 큰 파일 (100MB+) 처리 테스트

### 4.3 UI 테스트
- [ ] 4.3.1 Chrome 브라우저 테스트
- [ ] 4.3.2 Firefox 브라우저 테스트
- [ ] 4.3.3 Safari 브라우저 테스트
- [ ] 4.3.4 반응형 디자인 테스트
- [ ] 4.3.5 인터랙션 테스트 (클릭, 호버, ESC)

### 4.4 에러 케이스 테스트
- [ ] 4.4.1 scat 미설치 테스트
- [ ] 4.4.2 tshark 미설치 테스트
- [ ] 4.4.3 잘못된 파일 형식 테스트
- [ ] 4.4.4 손상된 파일 테스트
- [ ] 4.4.5 빈 파일 테스트

---

## 5. 문서화

### 5.1 사용자 문서
- [x] 5.1.1 README.md 작성
- [x] 5.1.2 설치 가이드 작성
- [x] 5.1.3 사용 방법 작성
- [x] 5.1.4 문제 해결 가이드 작성

### 5.2 개발자 문서
- [x] 5.2.1 프로젝트 구조 문서 작성
- [x] 5.2.2 기술 스택 문서 작성
- [x] 5.2.3 제품 개요 문서 작성
- [x] 5.2.4 스펙 문서 작성 (requirements, design, tasks)

### 5.3 코드 주석
- [x] 5.3.1 함수 docstring 작성
- [x] 5.3.2 복잡한 로직 주석 작성
- [x] 5.3.3 3GPP 표준 참조 주석 작성

---

## 6. 성능 최적화

### 6.1 백엔드 최적화
- [x] 6.1.1 큰 파일 처리 최적화 (timeout=None)
- [x] 6.1.2 디버그 정보 크기 제한
- [ ] 6.1.3 메모리 사용량 최적화
- [ ] 6.1.4 병렬 처리 검토

### 6.2 프론트엔드 최적화
- [x] 6.2.1 requestAnimationFrame 사용
- [x] 6.2.2 노드 위치 캐싱
- [ ] 6.2.3 가상 스크롤링 검토 (1000+ 메시지)
- [ ] 6.2.4 렌더링 성능 프로파일링

---

## 7. 보안 강화

### 7.1 파일 업로드 보안
- [x] 7.1.1 secure_filename 사용
- [x] 7.1.2 파일 크기 제한 (2GB)
- [ ] 7.1.3 파일 타입 검증 강화
- [ ] 7.1.4 업로드 디렉토리 권한 설정

### 7.2 서버 보안
- [ ] 7.2.1 프로덕션 모드 설정
- [ ] 7.2.2 HTTPS 지원
- [ ] 7.2.3 CORS 설정
- [ ] 7.2.4 Rate limiting

---

## 8. 향후 개선 사항

### 8.1 기능 추가
- [ ] 8.1.1 실시간 로그 스트리밍
- [ ] 8.1.2 메시지 필터링 기능
- [ ] 8.1.3 타임라인 뷰 추가
- [ ] 8.1.4 다중 파일 비교 기능
- [ ] 8.1.5 통계 및 분석 기능
- [ ] 8.1.6 메시지 검색 기능
- [ ] 8.1.7 북마크 기능
- [ ] 8.1.8 보고서 생성 (PDF/Excel)

### 8.2 통합
- [ ] 8.2.1 RTCP 품질 분석 통합
- [ ] 8.2.2 SA 세션 분석 통합
- [ ] 8.2.3 추가 분석 도구 통합

### 8.3 UI/UX 개선
- [ ] 8.3.1 다크 모드 지원
- [ ] 8.3.2 커스텀 테마 지원
- [ ] 8.3.3 키보드 단축키 추가
- [ ] 8.3.4 드래그 앤 드롭 업로드
- [ ] 8.3.5 진행률 바 개선

---

## 9. 배포 및 운영

### 9.1 배포 준비
- [x] 9.1.1 requirements.txt 최종 확인
- [x] 9.1.2 의존성 설치 스크립트 작성 (deploy.sh, deploy.bat)
- [x] 9.1.3 환경 변수 설정 가이드 작성 (README.Docker.md)
- [x] 9.1.4 Docker 이미지 생성 (Dockerfile, docker-compose.yml)
- [x] 9.1.5 GitHub Container Registry 자동 빌드 설정
- [x] 9.1.6 멀티 플랫폼 빌드 (AMD64)
- [x] 9.1.7 Lua 플러그인 전역 설치 (Docker)

### 9.2 운영
- [ ] 9.2.1 로깅 시스템 구축
- [ ] 9.2.2 모니터링 시스템 구축
- [ ] 9.2.3 백업 전략 수립
- [ ] 9.2.4 업데이트 프로세스 정의

---

## 10. 유지보수

### 10.1 버그 수정
- [ ] 10.1.1 이슈 트래킹 시스템 구축
- [ ] 10.1.2 버그 리포트 템플릿 작성
- [ ] 10.1.3 핫픽스 프로세스 정의

### 10.2 기능 개선
- [ ] 10.2.1 사용자 피드백 수집
- [ ] 10.2.2 개선 사항 우선순위 결정
- [ ] 10.2.3 릴리스 노트 작성

### 10.3 표준 업데이트
- [ ] 10.3.1 3GPP 표준 업데이트 모니터링
- [ ] 10.3.2 새로운 메시지 타입 추가
- [ ] 10.3.3 프로토콜 변경 사항 반영


---

## 11. 버전별 완료 태스크

### v1.2.2 (2026-01-29)
- [x] Docker 환경 NR RRC 파싱 문제 해결
- [x] Lua 플러그인 전역 설치 (Dockerfile)
- [x] converters.py Lua 플러그인 경로 수정
- [x] docker-compose.yml 개선 (version 제거, platform 명시)
- [x] README.md macOS ARM64 사용자 안내 추가
- [x] AMD64 단일 플랫폼 빌드

### v1.2.1 (2026-01-28)
- [x] GitHub Container Registry 지원
- [x] README 간소화
- [x] .dockerignore 최적화

### v1.2.0 (2026-01-28)
- [x] 모듈화 리팩토링 (app.py 1120줄 → 90줄)
- [x] converters.py, parsers.py, message_types.py, utils.py 분리
- [x] Docker 배포 지원 (Dockerfile, docker-compose.yml)
- [x] 자동 배포 스크립트 (deploy.sh, deploy.bat)
- [x] README.Docker.md 작성
- [x] debug 폴더 정리

### v1.1.0 (2026-01-28)
- [x] GSMTAPv3 배열 형식 지원 (NR/LTE RRC)
- [x] VoNR 파싱 안정성 개선 (254 → 302 메시지)
- [x] NR RRC 전용 디버그 섹션 추가
